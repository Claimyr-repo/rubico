/**
 * rubico v1.9.3
 * https://github.com/a-synchronous/rubico
 * (c) 2019-2021 Richard Tong
 * rubico may be freely distributed under the MIT license.
 */

!function(n,t){"object"==typeof module?module.exports=t:"function"==typeof define?define((()=>t)):n.reduce=t}("object"==typeof globalThis?globalThis:this,function(){"use strict";const n=n=>null!=n&&"function"==typeof n.then,t=Symbol.for("placeholder"),e=function(n,e,o,r){return e==t?((n,t,e)=>function(o){return n(o,t,e)})(n,o,r):o==t?((n,t,e)=>function(o){return n(t,o,e)})(n,e,r):((n,t,e)=>function(o){return n(t,e,o)})(n,e,o)},o=function(n,e,o,r){return e==t?((n,t,e)=>function(...o){return n(o,t,e)})(n,o,r):o==t?((n,t,e)=>function(...o){return n(t,o,e)})(n,e,r):((n,t,e)=>function(...o){return n(t,e,o)})(n,e,o)},r=Array.isArray,u=(Object.values,Object.prototype.toString),c=n=>u.call(n),i=async function(t,e,o){let r=t.next();if(r.done)return o;for(;!r.done;)o=e(o,r.value),n(o)&&(o=await o),r=t.next();return o},f=function(o,r,u){let c=o.next();if(c.done)return u;for(void 0===u&&(u=c.value,c=o.next());!c.done;){if(u=r(u,c.value),n(u))return u.then(e(i,o,r,t));c=o.next()}return u},a=async function(n,t,e){let o=await n.next();if(o.done)return e;for(void 0===e&&(e=o.value,o=await n.next());!o.done;)e=await t(e,o.value),o=await n.next();return e},l=Symbol.iterator,s=Symbol.asyncIterator,y=function(n,e,o){return e==t?((n,t)=>function(e){return n(e,t)})(n,o):((n,t)=>function(e){return n(t,e)})(n,e)},d=function(n,e,o,r,u){return e==t?((n,t,e,o)=>function(r){return n(r,t,e,o)})(n,o,r,u):o==t?((n,t,e,o)=>function(r){return n(t,r,e,o)})(n,e,r,u):r==t?((n,t,e,o)=>function(r){return n(t,e,r,o)})(n,e,o,u):((n,t,e,o)=>function(r){return n(t,e,o,r)})(n,e,o,r)},p=async function(t,e,o,r){const u=t.length;for(;++r<u;)o=e(o,t[r],r,t),n(o)&&(o=await o);return o},h=Object.keys,v=async function(t,e,o,r,u){const c=r.length;for(;++u<c;){const c=r[u];o=e(o,t[c],c,t),n(o)&&(o=await o)}return o},b=async function(t,e,o,r){for(const[u,c]of r)o=e(o,c,u,t),n(o)&&(o=await o);return o},x=(n,t)=>function(...e){return t(n(...e))},g=(e,o)=>function(r,u){const c=e(r,u);return n(c)?c.then(y(o,t,u)):o(c,u)},j=function(u,i,w){const m=u[0];return r(m)?function(e,o,r){const u=e.length;let c=-1;for(void 0===r&&(r=e[++c]);++c<u;)if(r=o(r,e[c],c,e),n(r))return r.then(d(p,e,o,t,c));return r}(m,i,w):"function"==typeof m?"[object GeneratorFunction]"==c(m)?((n,o,r)=>x(n,e(f,t,o,r)))(m,i,w):(n=>"[object AsyncGeneratorFunction]"==c(n))(m)?((n,o,r)=>x(n,e(a,t,o,r)))(m,i,w):o(j,t,1==u.length?g(i,m):u.reduce(g,i),w):null==m?void 0===w?y(i,m,t):i(w,m):m.constructor==Map?function(e,o,r){const u=e.entries();if(void 0===r){const n=u.next();if(n.done)return r;r=n.value[1]}for(const[c,i]of u)if(r=o(r,i,c,e),n(r))return r.then(d(b,e,o,t,u));return r}(m,i,w):"function"==typeof m[l]?f(m[l](),i,w):"function"==typeof m[s]?a(m[s](),i,w):"function"==typeof m.reduce?m.reduce(i,w):"function"==typeof m.chain?m.chain(y(i,w,t)):"function"==typeof m.flatMap?m.flatMap(y(i,w,t)):m.constructor==Object?function(e,o,r){const u=h(e),c=u.length;let i=-1;for(void 0===r&&(r=e[u[++i]]);++i<c;){const c=u[i];if(r=o(r,e[c],c,e),n(r))return r.then((f=v,l=o,s=t,y=u,d=i,(a=e)==t?((n,t,e,o,r)=>function(u){return n(u,t,e,o,r)})(f,l,s,y,d):l==t?((n,t,e,o,r)=>function(u){return n(t,u,e,o,r)})(f,a,s,y,d):s==t?((n,t,e,o,r)=>function(u){return n(t,e,u,o,r)})(f,a,l,y,d):y==t?((n,t,e,o,r)=>function(u){return n(t,e,o,u,r)})(f,a,l,s,d):((n,t,e,o,r)=>function(u){return n(t,e,o,r,u)})(f,a,l,s,y)))}var f,a,l,s,y,d;return r}(m,i,w):void 0===w?y(i,m,t):i(w,m)};return function(...r){if("function"!=typeof r[0]){const n=r[1],t=r[2];return j([r[0]],n,t)}const u=r[0],c=r[1];return"function"==typeof c?function(...o){const r=c(...o);return n(r)?r.then(e(j,o,u,t)):j(o,u,r)}:o(j,t,u,c)}}());
