/**
 * rubico v1.6.2
 * https://github.com/a-synchronous/rubico
 * (c) 2019-2020 Richard Tong
 * rubico may be freely distributed under the MIT license.
 */

!function(n,t){"object"==typeof module?module.exports=t:"function"==typeof define?define((()=>t)):n.fork=t}("object"==typeof globalThis?globalThis:this,function(){"use strict";const n=Array.isArray,t=n=>null!=n&&"function"==typeof n.then,o=Promise.all.bind(Promise),r=n=>new Promise((n=>function(o){const r={};let e=0;for(const u in n){const c=n[u];t(c)?(e+=1,c.then((n=>function(t){r[n]=t,e-=1,0==e&&o(r)})(u))):r[u]=c}0==e&&o(r)})(n)),e=n=>function(...o){const e={};let u=!1;for(const r in n){const c=n[r](...o);!u&&t(c)&&(u=!0),e[r]=c}return u?r(e):e},u=(n,o)=>function(...r){const e=n(...r);return t(e)?e.then(o):o(e)},c=Symbol.for("placeholder"),i=function(n,t,o,r,e){return t==c?((n,t,o,r)=>function(e){return n(e,t,o,r)})(n,o,r,e):o==c?((n,t,o,r)=>function(e){return n(t,e,o,r)})(n,t,r,e):r==c?((n,t,o,r)=>function(e){return n(t,o,e,r)})(n,t,o,e):((n,t,o,r)=>function(e){return n(t,o,r,e)})(n,t,o,r)},f=function(n,t,o){return n[t]=o,n},s=async function(n,o,r,e){const u=n.length;for(;++e<u;){const u=n[e](...o);r[e]=t(u)?await u:u}return r},l=r=>n(r)?(n=>function(...r){const e=n.length,u=Array(e);let c=-1,i=!1;for(;++c<e;){const o=n[c](...r);t(o)&&(i=!0),u[c]=o}return i?o(u):u})(r):e(r);return l.series=o=>n(o)?(n=>function(...o){const r=n.length,e=[];let l=-1;for(;++l<r;){const r=n[l](...o);if(t(r))return r.then(u((a=f,y=l,b=c,(h=e)==c?((n,t,o)=>function(r){return n(r,t,o)})(a,y,b):y==c?((n,t,o)=>function(r){return n(t,r,o)})(a,h,b):((n,t,o)=>function(r){return n(t,o,r)})(a,h,y)),i(s,n,o,c,l)));e[l]=r}var a,h,y,b;return e})(o):e(o),l}());
