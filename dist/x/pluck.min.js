/**
 * rubico v1.6.7
 * https://github.com/a-synchronous/rubico
 * (c) 2019-2020 Richard Tong
 * rubico may be freely distributed under the MIT license.
 */

!function(n,t){"object"==typeof module?module.exports=t:"function"==typeof define?define((()=>t)):n.pluck=t}("object"==typeof globalThis?globalThis:this,function(){"use strict";const n=n=>null!=n&&"function"==typeof n.then,t=(t,o)=>function(...e){const r=t(...e);return n(r)?r.then(o):o(r)},o=Symbol.iterator,e=(n,t)=>({toString:()=>"[object MappingIterator]",[o](){return this},next(){const o=n.next();return o.done?o:{value:t(o.value),done:!1}}}),r=n=>({value:n,done:!1}),c=Symbol.asyncIterator,u=(t,o)=>({[c](){return this},async next(){const e=await t.next();if(e.done)return e;const c=o(e.value);return n(c)?c.then(r):{value:c,done:!1}}}),i=Array.isArray,f=Object.prototype.toString,s=n=>f.call(n),l=Promise.all.bind(Promise),a=function(t,o){const e=t.length,r=Array(e);let c=-1,u=!1;for(;++c<e;){const e=o(t[c]);n(e)&&(u=!0),r[c]=e}return u?l(r):r},h=Symbol.for("placeholder"),y=(t,o)=>function(e,r){const c=o(r);return n(c)?c.then((u=t,f=h,(i=e)==h?((n,t)=>function(o){return n(o,t)})(u,f):((n,t)=>function(o){return n(t,o)})(u,i))):t(e,c);var u,i,f},p=function(n,t,o,e){return t==h?((n,t,o)=>function(e){return n(e,t,o)})(n,o,e):o==h?((n,t,o)=>function(e){return n(t,e,o)})(n,t,e):((n,t,o)=>function(e){return n(t,o,e)})(n,t,o)},d=(n,t,o)=>n[t](o),w=n=>function(){return n},g=function(n,t,o,e,r){return t==h?((n,t,o,e)=>function(r){return n(r,t,o,e)})(n,o,e,r):o==h?((n,t,o,e)=>function(r){return n(t,r,o,e)})(n,t,e,r):e==h?((n,t,o,e)=>function(r){return n(t,o,r,e)})(n,t,o,r):((n,t,o,e)=>function(r){return n(t,o,e,r)})(n,t,o,e)},b=(n,t,o,e)=>n[t](o,e),j=t=>new Promise((t=>function(o){const e={};let r=0;for(const c in t){const u=t[c];n(u)?(r+=1,u.then((n=>function(t){e[n]=t,r-=1,0==r&&o(e)})(c))):e[c]=u}0==r&&o(e)})(t)),m=function(n,t,o){return n[t]=o,n},A=async function(t,o,e,r){const c=t.length;for(;++r<c;){const c=o(t[r]);e[r]=n(c)?await c:c}return e},S=n=>function(...t){return n(...t),t[0]},v=Promise.race.bind(Promise),x=async function(t,o,e,r,c,u){const i=t.length;for(;++c<i;){u.size>=e&&await v(u);const i=o(t[c]);if(n(i)){const n=i.then(S((()=>u.delete(n))));u.add(n),r[c]=n}else r[c]=i}return l(r)},P=Object.prototype.hasOwnProperty,T=(n,t)=>P.call(n,t),O=t=>function(r){return i(r)?a(r,t):"function"==typeof r?(n=>"[object GeneratorFunction]"==s(n))(r)?((n,t)=>function*(...o){for(const e of n(...o))yield t(e)})(r,t):(n=>"[object AsyncGeneratorFunction]"==s(n))(r)?function(n,t){return async function*(...o){for await(const e of n(...o))yield t(e)}}(r,t):y(r,t):null==r?r:"function"==typeof r.then?r.then(t):"function"==typeof r.map?r.map(t):"function"==typeof r.next?o in r?e(r,t):u(r,t):"string"==typeof r||r.constructor==String?function(t,o){const e=a(t,o);return n(e)?e.then(p(d,h,"join","")):e.join("")}(r,t):r.constructor==Set?function(t,o){const e=new Set,r=[];for(const c of t){const t=o(c);n(t)?r.push(t.then(p(d,e,"add",h))):e.add(t)}return 0==r.length?e:l(r).then(w(e))}(r,t):r.constructor==Map?function(t,o){const e=new Map,r=[];for(const[c,u]of t){const t=o(u);n(t)?r.push(t.then(g(b,e,"set",c,h))):e.set(c,t)}return 0==r.length?e:l(r).then(w(e))}(r,t):r.constructor==Object?function(t,o){const e={};let r=!1;for(const c in t){const u=o(t[c]);n(u)&&(r=!0),e[c]=u}return r?j(e):e}(r,t):t(r)};O.series=o=>function(e){if(i(e))return function(o,e){const r=o.length,c=Array(r);let u=-1;for(;++u<r;){const r=e(o[u]);if(n(r))return r.then(t(p(m,c,u,h),g(A,o,e,h,u)));c[u]=r}return c}(e,o);throw new TypeError(e+" is not an Array")},O.pool=(t,o)=>function(e){if(i(e))return function(t,o,e){const r=t.length,c=Array(r);let u=-1;for(;++u<r;){const r=o(t[u]);if(n(r)){const n=new Set,i=r.then(S((()=>n.delete(i))));return n.add(i),c[u]=i,x(t,o,e,c,u,n)}c[u]=r}return c}(e,o,t);throw new TypeError(e+" is not an Array")},O.withIndex=t=>function(o){if(i(o))return function(t,o){const e=t.length,r=Array(e);let c=-1,u=!1;for(;++c<e;){const e=o(t[c],c,t);n(e)&&(u=!0),r[c]=e}return u?l(r):r}(o,t);throw new TypeError(o+" is not an Array")},O.own=t=>function(o){if((n=>null!=n&&("object"==typeof n||"function"==typeof n))(o)&&!i(o))return function(t,o){const e={};let r=!1;for(const c in t)if(T(t,c)){const u=o(t[c]);n(u)&&(r=!0),e[c]=u}return r?j(e):e}(o,t);throw new TypeError(o+" is not an Object")};const E=/[.|[|\]]+/,M=function(n,t){const o=new Map,e=function(e){if(o.has(e))return o.get(e);const r=n(e);return o.set(e,r),o.size>t&&o.clear(),r};return e.cache=o,e}((function(n){const t=n.length-1,o="["==n[0],e="]"==n[t];return o&&e?n.slice(1,t).split(E):o?n.slice(1).split(E):e?n.slice(0,t).split(E):n.split(E)}),500),I=function(n,t){const o=(n=>i(n)?n:"string"==typeof n?M(n):[n])(t),e=o.length;let r=-1,c=n;for(;++r<e;)if(c=c[o[r]],null==c)return;return c};return t(((n,t)=>function(o){const e=null==o?void 0:I(o,n);return void 0===e?"function"==typeof t?t(o):t:e}),O)}());
